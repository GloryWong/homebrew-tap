# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Updown < Formula
  desc "A CLI tool to upload or download files to or from GitHub Gist"
  homepage "https://github.com/GloryWong/updown"
  version "1.5.5"
  license "MIT"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.5/updown_1.5.5_darwin_amd64.tar.gz"
      sha256 "a66b5d4ac7041269f7db0d2917c0ca164e5ad7f0189b992483ac6e60f7122232"

      def install
        bin.install "updown"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.5/updown_1.5.5_darwin_arm64.tar.gz"
      sha256 "33d6793911bb5839121ff7f930127d6a30dadbcee6d6d4b09f82221bcc8bbd1f"

      def install
        bin.install "updown"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/GloryWong/updown/releases/download/v1.5.5/updown_1.5.5_linux_amd64.tar.gz"
        sha256 "fa10a9feeb7b36ad6e77512a795efeae03b2c7aec7c122e82c02be635a6c7992"

        def install
          bin.install "updown"
        end
      end
    end
    if Hardware::CPU.arm?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/GloryWong/updown/releases/download/v1.5.5/updown_1.5.5_linux_arm64.tar.gz"
        sha256 "d98519a89eed9d6e48ff0a5cab4be56948827a7e88eda2790b4432f404d89f2e"

        def install
          bin.install "updown"
        end
      end
    end
  end

  def post_install
    # Ensure the ~/.updown/logs directory exists
    (Pathname.new(Dir.home)/".updown/logs").mkpath
  end

  def caveats
    <<~EOS
      updown --help
    EOS
  end

  service do
    run [opt_bin/"updown", "upload", "--quiet", "--notify"]
    run_type :cron
    cron "0 15 * * *" # 15:00 every day
    log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.log"
    error_log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.error.log"
    environment_variables PATH: std_service_path_env
  end

  test do
    system "#{bin}/updown --version"
  end
end
