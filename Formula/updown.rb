# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Updown < Formula
  desc "A CLI tool to upload or download files to or from GitHub Gist"
  homepage "https://github.com/GloryWong/updown"
  version "1.5.4"
  license "MIT"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.4/updown_1.5.4_darwin_amd64.tar.gz"
      sha256 "96b47b61a8d799abbc687d5bf3a12264f47625ab6ef7fe980d08703dfe7e67d6"

      def install
        bin.install "updown"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.4/updown_1.5.4_darwin_arm64.tar.gz"
      sha256 "db6c45005a1bbbf9a91dd2a25721b00bbf49c743f27b9bdaf67b08a6b2106240"

      def install
        bin.install "updown"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/GloryWong/updown/releases/download/v1.5.4/updown_1.5.4_linux_amd64.tar.gz"
        sha256 "1b470be858211a88e013f40fc473066ba1bf086aba4dbc2dfd2ddbec94dae1a2"

        def install
          bin.install "updown"
        end
      end
    end
    if Hardware::CPU.arm?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/GloryWong/updown/releases/download/v1.5.4/updown_1.5.4_linux_arm64.tar.gz"
        sha256 "a0a616f7ac2fc59facb1331641f33ac6767845f8f25cbd1b95140c7001b906fb"

        def install
          bin.install "updown"
        end
      end
    end
  end

  def post_install
    # Ensure the ~/.updown/logs directory exists
    (Pathname.new(Dir.home)/".updown/logs").mkpath
  end

  def caveats
    <<~EOS
      updown --help
    EOS
  end

  service do
    run [opt_bin/"updown", "upload", "--quiet", "--notify"]
    run_type :cron
    cron "0 15 * * *" # 15:00 every day
    log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.log"
    error_log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.error.log"
    environment_variables PATH: std_service_path_env
  end

  test do
    system "#{bin}/updown --version"
  end
end
