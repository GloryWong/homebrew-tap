# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Updown < Formula
  desc "A CLI tool to upload or download files to or from GitHub Gist"
  homepage "https://github.com/GloryWong/updown"
  version "1.5.7"
  license "MIT"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.7/updown_1.5.7_darwin_amd64.tar.gz"
      sha256 "baf20f88cb4fe6bd0f3a6add007668adfb7868383aa535e0b6631faaa8ddfcba"

      def install
        bin.install "updown"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.7/updown_1.5.7_darwin_arm64.tar.gz"
      sha256 "99e70113c83f677816fc5f01141e1a256a04c70e833f6e29f4dc51fecaef08bf"

      def install
        bin.install "updown"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel? and Hardware::CPU.is_64_bit?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.7/updown_1.5.7_linux_amd64.tar.gz"
      sha256 "f43da25b20cc0251d684f484f0d002c32b18f18962b858ea76806b9974134127"
      def install
        bin.install "updown"
      end
    end
    if Hardware::CPU.arm? and Hardware::CPU.is_64_bit?
      url "https://github.com/GloryWong/updown/releases/download/v1.5.7/updown_1.5.7_linux_arm64.tar.gz"
      sha256 "5fb39e0f9f131528183765fc3ab75471440c3082c77ff0740de4b6eed8002eab"
      def install
        bin.install "updown"
      end
    end
  end

  def post_install
    # Ensure the ~/.updown/logs directory exists
    (Pathname.new(Dir.home)/".updown/logs").mkpath
  end

  def caveats
    <<~EOS
      updown --help
    EOS
  end

  service do
    run [opt_bin/"updown", "upload", "--quiet", "--notify"]
    run_type :cron
    cron "0 15 * * *" # 15:00 every day
    log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.log"
    error_log_path Pathname.new(Dir.home)/".updown/logs/updown-brew-service.error.log"
    environment_variables PATH: std_service_path_env
  end

  test do
    system "#{bin}/updown --version"
  end
end
